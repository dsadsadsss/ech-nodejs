const port = process.env.SERVER_PORT || process.env.PORT || 3000;
const vmms = process.env.VPATH || 'vls'; 
const vmmport = process.env.EPORT || '8001';  //固定隧道端口
const ekey = process.env.EKEY || 'ech123456';  // ech密钥，需ech-tunnel 客户端
const uuid = process.env.SUBPATH || '7a8a1de5-7d41-45e2-88fe-0f538b827169';  //订阅地址
const youxuan = process.env.CF_IP || 'ip.sb';
const sub_name = process.env.SUB_NAME || 'ech';   //节点名称
const sub_url = process.env.SUB_URL || '';    //订阅服务器地址
const baohuo = process.env.BAOHUO_URL || '';//自动访问网址，可以保活
const nezhaser = process.env.NSERVER || 'xx:443';  // v1哪吒,格式地址:端口
const nezhaKey = process.env.NKEY || '';
const nezport = process.env.NPORT || '443';
const neztls = process.env.NTLS || '--tls';
const filePath = process.env.PWD || '/tmp/';
const tok = process.env.TOK || '';  //固定隧道
let host_name = '';
if (tok) {
   host_name = process.env.DOM || '';
}
const _0x1e78c6=_0x4e7c;(function(_0x11aa89,_0x2e8a71){const _0x4f1c6d=_0x4e7c,_0x33bbb8=_0x11aa89();while(!![]){try{const _0x48a72f=parseInt(_0x4f1c6d(0x20c))/0x1*(parseInt(_0x4f1c6d(0x257))/0x2)+parseInt(_0x4f1c6d(0x277))/0x3+parseInt(_0x4f1c6d(0x231))/0x4+-parseInt(_0x4f1c6d(0x289))/0x5+parseInt(_0x4f1c6d(0x24b))/0x6*(parseInt(_0x4f1c6d(0x27d))/0x7)+-parseInt(_0x4f1c6d(0x1fb))/0x8*(-parseInt(_0x4f1c6d(0x286))/0x9)+-parseInt(_0x4f1c6d(0x200))/0xa;if(_0x48a72f===_0x2e8a71)break;else _0x33bbb8['push'](_0x33bbb8['shift']());}catch(_0x520167){_0x33bbb8['push'](_0x33bbb8['shift']());}}}(_0x28c2,0xa943f));const nezhaHasPort=nezhaser[_0x1e78c6(0x204)](':'),crypto=require(_0x1e78c6(0x203)),seed=''+sub_name+ekey+nezhaser+nezhaKey+tok,hash=crypto['createHash']('sha256')['update'](seed)[_0x1e78c6(0x264)](_0x1e78c6(0x244)),AGENT_UUID1=hash[_0x1e78c6(0x23f)](0x0,0x8)+'-'+hash[_0x1e78c6(0x23f)](0x8,0xc)+'-'+hash['substring'](0xc,0x10)+'-'+hash[_0x1e78c6(0x23f)](0x10,0x14)+'-'+hash[_0x1e78c6(0x23f)](0x14,0x20),AGENT_UUID=process[_0x1e78c6(0x1f5)][_0x1e78c6(0x261)]||AGENT_UUID1||'fraewrwdf-das-2sd2-4324-f232df',NEZHA_URL_X64=process[_0x1e78c6(0x1f5)]['NEZHA_URL_X64']||_0x1e78c6(0x268),NEZHA_URL_ARM64=process[_0x1e78c6(0x1f5)][_0x1e78c6(0x212)]||_0x1e78c6(0x25b),NEZHA_URL_BSD=process[_0x1e78c6(0x1f5)][_0x1e78c6(0x1fe)]||_0x1e78c6(0x25d),NEZHA_URL_X64_ALT=process[_0x1e78c6(0x1f5)]['NEZHA_URL_X64_ALT']||_0x1e78c6(0x266),NEZHA_URL_ARM64_ALT=process['env'][_0x1e78c6(0x258)]||_0x1e78c6(0x274),NEZHA_URL_BSD_ALT=process[_0x1e78c6(0x1f5)][_0x1e78c6(0x217)]||_0x1e78c6(0x207),WEB_URL_X64=process['env'][_0x1e78c6(0x234)]||_0x1e78c6(0x279),WEB_URL_ARM64=process[_0x1e78c6(0x1f5)]['WEB_URL_ARM64']||_0x1e78c6(0x24e),WEB_URL_BSD=process[_0x1e78c6(0x1f5)][_0x1e78c6(0x252)]||_0x1e78c6(0x20f),CFF_URL_X64=process[_0x1e78c6(0x1f5)]['CFF_URL_X64']||_0x1e78c6(0x1f7),CFF_URL_ARM64=process[_0x1e78c6(0x1f5)][_0x1e78c6(0x1fc)]||_0x1e78c6(0x1f9),CFF_URL_BSD=process[_0x1e78c6(0x1f5)]['CFF_URL_BSD']||_0x1e78c6(0x23c),WEB_FILENAME=process[_0x1e78c6(0x1f5)][_0x1e78c6(0x282)]||_0x1e78c6(0x1f6),NEZHA_FILENAME=process[_0x1e78c6(0x1f5)][_0x1e78c6(0x224)]||_0x1e78c6(0x220),CFF_FILENAME=process['env'][_0x1e78c6(0x1f2)]||_0x1e78c6(0x27c),express=require(_0x1e78c6(0x22b)),app=express(),{spawn}=require(_0x1e78c6(0x22e)),os=require('os'),{createProxyMiddleware}=require(_0x1e78c6(0x227)),https=require(_0x1e78c6(0x1ef)),http=require('http'),fs=require('fs'),path=require(_0x1e78c6(0x233)),axios=require(_0x1e78c6(0x213)),childProcesses=new Map();function _0x4e7c(_0x1daae0,_0x721570){_0x1daae0=_0x1daae0-0x1ee;const _0x28c25b=_0x28c2();let _0x4e7cbc=_0x28c25b[_0x1daae0];return _0x4e7cbc;}console[_0x1e78c6(0x24c)](_0x1e78c6(0x25a)),console[_0x1e78c6(0x24c)](''),console[_0x1e78c6(0x24c)](_0x1e78c6(0x1ee)),console[_0x1e78c6(0x24c)](_0x1e78c6(0x288)),console['log']('\x20\x20\x20\x20\x20/'+uuid+_0x1e78c6(0x281)),console[_0x1e78c6(0x24c)](''),console['log'](_0x1e78c6(0x25a)),app[_0x1e78c6(0x254)]('/',function(_0x17ba71,_0x3fc1ff){const _0x48e7ef=_0x1e78c6;_0x3fc1ff['send'](_0x48e7ef(0x27e));});let countryCode='未知',up_url='',encodedUrl='';function getCountryName(_0x583df9){const _0x2c257b=_0x1e78c6;https[_0x2c257b(0x254)](_0x2c257b(0x202),_0x5d2a65=>{const _0x560f48=_0x2c257b;let _0x2121ab='';_0x5d2a65['on'](_0x560f48(0x219),_0x492b43=>{_0x2121ab+=_0x492b43;}),_0x5d2a65['on']('end',()=>{const _0x46ed03=_0x560f48,_0x39addb=_0x2121ab['trim']();_0x39addb&&_0x39addb['length']>0x0?_0x583df9(_0x39addb):(console[_0x46ed03(0x27a)](_0x46ed03(0x251)),_0x583df9('未知'));});})['on'](_0x2c257b(0x27a),_0x1a0bdc=>{const _0x5e283f=_0x2c257b;console['error'](_0x5e283f(0x206)+_0x1a0bdc[_0x5e283f(0x235)]),_0x583df9('未知');});}getCountryName(_0x4bc1ce=>{countryCode=_0x4bc1ce;});let lastHostName='',lastSentTime=0x0;function checkHostNameChange(_0xaf7c85){const _0x14a492=_0x1e78c6;if(!tok){const _0x580d65=path[_0x14a492(0x262)](filePath,_0x14a492(0x21b));fs[_0x14a492(0x230)](_0x580d65,_0x14a492(0x228),(_0x4fa203,_0x26468c)=>{const _0x2b16d1=_0x14a492;if(_0x4fa203)return console[_0x2b16d1(0x27a)](_0x2b16d1(0x240)+_0x4fa203[_0x2b16d1(0x235)]),_0xaf7c85();const _0x5cc3d2=/https:\/\/([a-z0-9-]+\.trycloudflare\.com)/g,_0x534055=[..._0x26468c[_0x2b16d1(0x267)](_0x5cc3d2)];if(_0x534055[_0x2b16d1(0x21f)]>0x0){const _0x292018=_0x534055[_0x534055['length']-0x1][0x1];_0x292018&&_0x292018!==lastHostName&&(console[_0x2b16d1(0x24c)](_0x2b16d1(0x271)+_0x292018),host_name=_0x292018,lastHostName=_0x292018,buildUrls());}_0xaf7c85();});}else _0xaf7c85();}function _0x28c2(){const _0x3c0194=['节点名称设置失败:\x20无法连接到哪吒面板','节点名称设置失败,状态码:\x20','application/json','NEZHA_URL_BSD_ALT','config.yml\x20created\x20successfully.','data','https://','argo.log','has','writeFile','chmod','length','nexus','|dns.alidns.com/dns-query|cloudflare-ech.com#','location','linux','NEZHA_FILENAME','json','\x0adebug:\x20false\x0adisable_auto_update:\x20false\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20false\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x203\x0aserver:\x20','http-proxy-middleware','utf8','All\x20downloads\x20and\x20config\x20creation\x20successful!','SPACE_HOST','express','-token','http://localhost:','child_process','Download\x20web\x20successful','readFile','2022304PnfzfZ','/start','path','WEB_URL_X64','message','Some\x20downloads\x20or\x20config\x20creation\x20failed,\x20but\x20proceeding\x20with\x20startup.','使用国家名称:','arm64','--token','platform','finish','https://github.com/dsadsadsss/1/releases/download/xry/argo-bsdamd','节点名称设置失败:\x20','x64','substring','Error\x20reading\x20argo.log:\x20','Failed\x20to\x20start\x20','from','Failed\x20to\x20start','hex','--no-autoupdate','Failed\x20to\x20check\x20or\x20start\x20nezgix\x20process:\x20','\x20|\x20','client_secret:\x20','\x20exited\x20with\x20code\x20','节点名称设置失败，可能哪吒面板未设置API_TOKEN\x20(状态码:\x20','54sDDQcv','log','Process\x20','https://github.com/dsadsadsss/ECH-Tunnel-Go/releases/download/v1/ech-tunnel-linux-arm64','statusCode','Download\x20cff\x20failed','获取的国家名称为空','WEB_URL_BSD','\x20started\x20successfully!','get','Started','Download\x20cff\x20successful','2LTkqTZ','NEZHA_URL_ARM64_ALT','Unsupported\x20platform\x20or\x20architecture','==============================','https://github.com/Fscarmon/flies/releases/latest/download/agent-linux_arm64','request','https://github.com/Fscarmon/flies/releases/latest/download/agent-freebsd_amd64','Failed\x20to\x20check\x20or\x20start\x20webapp\x20process:\x20','unref','--edge-ip-version','AGENT_UUID','join','ignore','digest','set','https://github.com/Fscarmon/flies/releases/latest/download/agent2-linux_amd64','matchAll','https://github.com/Fscarmon/flies/releases/latest/download/agent-linux_amd64','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','--url','错误:\x20AGENT_UUID\x20环境变量未设置','nx-app\x20listening\x20on\x20port\x20','killed','run','toString','freebsd','host_name\x20set\x20to\x20','Failed\x20to\x20check\x20or\x20start\x20cffghapp\x20process:\x20','unlink','https://github.com/Fscarmon/flies/releases/latest/download/agent2-linux_arm64','now','\x20is\x20already\x20running','3076344mxxKAA','Already\x20running','https://github.com/dsadsadsss/ECH-Tunnel-Go/releases/download/v1/ech-tunnel-linux-amd64','error','response','cfloat','552671LQwFri','hello\x20world','exit','push','\x20订阅','WEB_FILENAME','config.yml','auto','--protocol','4365YkAmJg','status','\x20\x20\x20\x20\x20/start\x20检查进程','6018445iUGlJJ','\x20\x20\x20\x20\x20/info\x20系统信息','https','/upload','send','CFF_FILENAME','!\x0a==============================','Sub\x20Upload\x20successful','env','webdav','https://github.com/Fscarmon/flies/releases/latest/download/cff-linux-amd64','--tls','https://github.com/Fscarmon/flies/releases/latest/download/cff-linux-arm64','ws://0.0.0.0:','14056HuXoIg','CFF_URL_ARM64','close','NEZHA_URL_BSD',':443|','13861170aoijgu','delete','https://ip.xuexi365.eu.org','crypto','includes','arch','获取国家名称失败:\x20','https://github.com/Fscarmon/flies/releases/latest/download/agent2-freebsd_amd64','tunnel','startsWith','Failed\x20to\x20create\x20config.yml:\x20','PROJECT_DOMAIN','189371pEyxKZ','exitCode','ech://','https://github.com/dsadsadsss/ECH-Tunnel-Go/releases/download/v1/ech-tunnel-freebsd-amd64','pipe','listen','NEZHA_URL_ARM64','axios'];_0x28c2=function(){return _0x3c0194;};return _0x28c2();}function buildUrls(){const _0xedaab4=_0x1e78c6;up_url=_0xedaab4(0x20e)+host_name+_0xedaab4(0x1ff)+ekey+'|'+youxuan+_0xedaab4(0x221)+countryCode+_0xedaab4(0x247)+sub_name,encodedUrl=Buffer[_0xedaab4(0x242)](up_url)[_0xedaab4(0x26f)]('base64');}function initializeData(){getCountryName(_0x1fd74c=>{const _0x8a2764=_0x4e7c;_0x1fd74c?(countryCode=_0x1fd74c,console[_0x8a2764(0x24c)](_0x8a2764(0x237),countryCode),checkHostNameChange(()=>{buildUrls();})):(console[_0x8a2764(0x27a)]('获取国家名称失败，使用默认值\x22未知\x22'),countryCode='未知',checkHostNameChange(()=>{buildUrls();}));});}function sendSubscription(){const _0xa76541=_0x1e78c6,_0x38fdd6={'URL_NAME':sub_name,'URL':up_url};axios['post'](sub_url,_0x38fdd6,{'headers':{'Content-Type':_0xa76541(0x216)}})['then'](_0x48ee03=>{const _0x28a919=_0xa76541;console[_0x28a919(0x24c)](_0x28a919(0x1f4));})['catch'](_0x36911e=>{const _0x2e4992=_0xa76541;console[_0x2e4992(0x27a)]('Sub\x20Upload\x20failed');});}function startCronJob(){!tok?setInterval(()=>{checkHostNameChange(()=>{const _0x3391a0=_0x4e7c,_0x95eb3d=Date[_0x3391a0(0x275)]();_0x95eb3d-lastSentTime>=0x5*0x3c*0x3e8&&(sendSubscription(),lastSentTime=_0x95eb3d);});},0x3c*0x3e8):(buildUrls(),sendSubscription(),setInterval(()=>{const _0x48ba41=_0x4e7c,_0x18978c=Date[_0x48ba41(0x275)]();_0x18978c-lastSentTime>=0x5*0x3c*0x3e8&&(sendSubscription(),lastSentTime=_0x18978c);},0x3c*0x3e8));}app[_0x1e78c6(0x254)]('/'+uuid,(_0x4737b3,_0x35b54d)=>{const _0x3f532e=_0x1e78c6;_0x35b54d[_0x3f532e(0x1f1)](encodedUrl);});function checkProcessStatus(_0x4e922c,_0x55a69e){const _0x4614b7=_0x1e78c6;if(childProcesses[_0x4614b7(0x21c)](_0x4e922c)){const _0x23c6d4=childProcesses['get'](_0x4e922c);if(_0x23c6d4&&!_0x23c6d4[_0x4614b7(0x26d)]&&_0x23c6d4[_0x4614b7(0x20d)]===null){_0x55a69e(!![]);return;}else childProcesses[_0x4614b7(0x201)](_0x4e922c);}_0x55a69e(![]);}function startProcess(_0xc5cd43,_0x4e5e36,_0x591693,_0x1bda61={}){const _0x4218f8=_0x1e78c6;try{const _0x2c0c24=spawn(_0x4e5e36,_0x591693,{'detached':!![],'stdio':_0x4218f8(0x263),..._0x1bda61});return _0x2c0c24[_0x4218f8(0x25f)](),childProcesses[_0x4218f8(0x265)](_0xc5cd43,_0x2c0c24),_0x2c0c24['on'](_0x4218f8(0x27f),_0x1b7872=>{const _0x26f7d5=_0x4218f8;console[_0x26f7d5(0x24c)](_0x26f7d5(0x24d)+_0xc5cd43+_0x26f7d5(0x249)+_0x1b7872),childProcesses[_0x26f7d5(0x201)](_0xc5cd43);}),_0x2c0c24;}catch(_0x354515){return console[_0x4218f8(0x27a)](_0x4218f8(0x241)+_0xc5cd43+':',_0x354515[_0x4218f8(0x235)]),null;}}app['get'](_0x1e78c6(0x232),(_0x12ac0a,_0x52d534)=>{const _0xc04d0=[];checkProcessStatus(CFF_FILENAME,_0x445b39=>{const _0x48a91c=_0x4e7c;if(!_0x445b39){const _0x581e8a=path['join'](filePath,CFF_FILENAME);let _0x30df98;tok?_0x30df98=['tunnel',_0x48a91c(0x260),_0x48a91c(0x284),'--protocol','auto',_0x48a91c(0x26e),_0x48a91c(0x245),_0x48a91c(0x239),tok]:_0x30df98=['tunnel',_0x48a91c(0x260),'auto',_0x48a91c(0x285),'auto',_0x48a91c(0x26a),_0x48a91c(0x22d)+vmmport,_0x48a91c(0x245)];const _0x491099=startProcess(CFF_FILENAME,_0x581e8a,_0x30df98);_0xc04d0[_0x48a91c(0x280)]({'process':CFF_FILENAME,'status':_0x491099?_0x48a91c(0x255):_0x48a91c(0x243)});}else _0xc04d0[_0x48a91c(0x280)]({'process':CFF_FILENAME,'status':_0x48a91c(0x278)});}),checkProcessStatus(WEB_FILENAME,_0x5251f=>{const _0x276d8b=_0x4e7c;if(!_0x5251f){const _0x3e8a92=path['join'](filePath,WEB_FILENAME),_0x3140e7=['-l','ws://0.0.0.0:'+vmmport,_0x276d8b(0x22c),ekey],_0x296c8c=startProcess(WEB_FILENAME,_0x3e8a92,_0x3140e7);_0xc04d0[_0x276d8b(0x280)]({'process':WEB_FILENAME,'status':_0x296c8c?_0x276d8b(0x255):_0x276d8b(0x243)});}else _0xc04d0['push']({'process':WEB_FILENAME,'status':_0x276d8b(0x278)});}),nezhaser&&nezhaKey&&checkProcessStatus(NEZHA_FILENAME,_0x5d55b0=>{const _0x144ddd=_0x4e7c;if(!_0x5d55b0){const _0x458531=path[_0x144ddd(0x262)](filePath,NEZHA_FILENAME);let _0xcf8899;nezhaHasPort?_0xcf8899=['-c',path[_0x144ddd(0x262)](filePath,_0x144ddd(0x283))]:(_0xcf8899=['-s',nezhaser+':'+nezport,'-p',nezhaKey],neztls==='--tls'&&_0xcf8899[_0x144ddd(0x280)](_0x144ddd(0x1f8)));const _0x4d64f7=startProcess(NEZHA_FILENAME,_0x458531,_0xcf8899);_0xc04d0['push']({'process':NEZHA_FILENAME,'status':_0x4d64f7?_0x144ddd(0x255):_0x144ddd(0x243)});}else _0xc04d0[_0x144ddd(0x280)]({'process':NEZHA_FILENAME,'status':_0x144ddd(0x278)});}),setTimeout(()=>{const _0x5eb9da=_0x4e7c;_0x52d534[_0x5eb9da(0x225)]({'message':'Process\x20check\x20and\x20start\x20completed','processes':_0xc04d0});},0x3e8);}),app['use']('/'+vmms,createProxyMiddleware({'changeOrigin':!![],'onProxyReq':function(_0x3789dd,_0x17c798,_0xbcbc83){},'pathRewrite':{['^/'+vmms]:'/'+vmms},'target':'http://127.0.0.1:'+vmmport+'/','ws':!![]}));function checkAndStartProcess(_0x5cc2a1,_0x1ee7bc,_0x58481c,_0x913882){checkProcessStatus(_0x5cc2a1,_0x173dc7=>{const _0x556284=_0x4e7c;if(_0x173dc7)_0x913882(null,_0x5cc2a1+_0x556284(0x276));else{const _0xb2f2f1=startProcess(_0x5cc2a1,_0x1ee7bc,_0x58481c);_0xb2f2f1?_0x913882(null,_0x5cc2a1+_0x556284(0x253)):_0x913882(new Error('Failed\x20to\x20start\x20'+_0x5cc2a1));}});}function startCheckingProcesses(){const _0x2a9276=setInterval(()=>{checkProcesses();},0x3c*0x3e8);}function checkProcesses(){nezhaser&&nezhaKey&&keep_nezha_alive(),keep_cff_alive(),keep_web_alive();}function makeKeepAliveRequest(_0x374832){const _0xeedc5=_0x1e78c6;if(!_0x374832)return;const _0x3ca43b=_0x374832[_0xeedc5(0x209)](_0xeedc5(0x1ef))?https:http;_0x3ca43b[_0xeedc5(0x254)](_0x374832,_0x3d5523=>{_0x3d5523['on']('data',()=>{});})['on'](_0xeedc5(0x27a),_0x6c69e6=>{});}function keep_web_alive(){const _0x4435c4=_0x1e78c6,_0x55d62c=WEB_FILENAME,_0x103583=path['join'](filePath,WEB_FILENAME),_0x3f0c85=['-l',_0x4435c4(0x1fa)+vmmport,_0x4435c4(0x22c),ekey];checkAndStartProcess(_0x55d62c,_0x103583,_0x3f0c85,(_0x5779d8,_0x13e48f)=>{const _0x18a925=_0x4435c4;_0x5779d8?console['log'](_0x18a925(0x25e)+_0x5779d8[_0x18a925(0x235)]):console[_0x18a925(0x24c)](_0x13e48f);});if(process[_0x4435c4(0x1f5)][_0x4435c4(0x22a)])makeKeepAliveRequest(_0x4435c4(0x21a)+process[_0x4435c4(0x1f5)][_0x4435c4(0x22a)]);else{if(baohuo)makeKeepAliveRequest('https://'+baohuo);else process[_0x4435c4(0x1f5)][_0x4435c4(0x20b)]&&makeKeepAliveRequest(_0x4435c4(0x21a)+process['env'][_0x4435c4(0x20b)]+'.glitch.me');}}function keep_nezha_alive(){const _0x2c2067=_0x1e78c6,_0x113f5b=NEZHA_FILENAME,_0x427187=path[_0x2c2067(0x262)](filePath,NEZHA_FILENAME);let _0x2704ef;nezhaHasPort?_0x2704ef=['-c',path[_0x2c2067(0x262)](filePath,_0x2c2067(0x283))]:(_0x2704ef=['-s',nezhaser+':'+nezport,'-p',nezhaKey],neztls===_0x2c2067(0x1f8)&&_0x2704ef[_0x2c2067(0x280)](_0x2c2067(0x1f8))),checkAndStartProcess(_0x113f5b,_0x427187,_0x2704ef,(_0x18e1c2,_0x3e4b24)=>{const _0x2610a5=_0x2c2067;_0x18e1c2?console['log'](_0x2610a5(0x246)+_0x18e1c2[_0x2610a5(0x235)]):console['log'](_0x3e4b24);});}function keep_cff_alive(){const _0x25203f=_0x1e78c6,_0x62ba35=CFF_FILENAME,_0xf25bd3=path['join'](filePath,CFF_FILENAME);let _0x5d60e3;tok?_0x5d60e3=[_0x25203f(0x208),_0x25203f(0x260),'auto',_0x25203f(0x285),_0x25203f(0x284),'--no-autoupdate',_0x25203f(0x26e),_0x25203f(0x239),tok]:_0x5d60e3=[_0x25203f(0x208),_0x25203f(0x260),_0x25203f(0x284),_0x25203f(0x285),_0x25203f(0x284),'--url',_0x25203f(0x22d)+vmmport,'--no-autoupdate'],checkAndStartProcess(_0x62ba35,_0xf25bd3,_0x5d60e3,(_0x10651f,_0x27b092)=>{const _0x27e52a=_0x25203f;_0x10651f?console[_0x27e52a(0x24c)](_0x27e52a(0x272)+_0x10651f[_0x27e52a(0x235)]):console['log'](_0x27b092);});}function downloadFile(_0x3439ce,_0x561cdc,_0x37e2d4){const _0x181cd2=_0x1e78c6,_0x3ed261=fs['createWriteStream'](_0x561cdc),_0x1be611=_0x3439ce[_0x181cd2(0x209)](_0x181cd2(0x1ef))?https:http;_0x1be611['get'](_0x3439ce,_0x3d286b=>{const _0xfc862c=_0x181cd2;if(_0x3d286b['statusCode']===0x12e||_0x3d286b[_0xfc862c(0x24f)]===0x12d){_0x3ed261[_0xfc862c(0x1fd)](),fs[_0xfc862c(0x273)](_0x561cdc,()=>{}),downloadFile(_0x3d286b['headers'][_0xfc862c(0x222)],_0x561cdc,_0x37e2d4);return;}if(_0x3d286b[_0xfc862c(0x24f)]!==0xc8){_0x37e2d4('下载失败，状态码:\x20'+_0x3d286b[_0xfc862c(0x24f)]);return;}_0x3d286b[_0xfc862c(0x210)](_0x3ed261),_0x3ed261['on'](_0xfc862c(0x23b),()=>{const _0x4bebd1=_0xfc862c;_0x3ed261[_0x4bebd1(0x1fd)](()=>{const _0x3693bb=_0x4bebd1;fs[_0x3693bb(0x21e)](_0x561cdc,0x1ff,_0x46b153=>{_0x46b153?_0x37e2d4('Failed\x20to\x20set\x20executable\x20permission:\x20'+_0x46b153):_0x37e2d4(null);});});});})['on'](_0x181cd2(0x27a),_0x1802d6=>{const _0x35049c=_0x181cd2;fs[_0x35049c(0x273)](_0x561cdc,()=>{}),_0x37e2d4('下载文件失败:\x20'+_0x1802d6[_0x35049c(0x235)]);});}function download_web(_0x3ff645){const _0x2e985c=_0x1e78c6,_0x30b191=os[_0x2e985c(0x23a)](),_0x2e3489=os['arch']();let _0x17d4d5='';if(_0x30b191===_0x2e985c(0x223)){if(_0x2e3489==='x64')_0x17d4d5=WEB_URL_X64;else _0x2e3489===_0x2e985c(0x238)&&(_0x17d4d5=WEB_URL_ARM64);}else{if(_0x30b191==='freebsd')_0x17d4d5=WEB_URL_BSD;else{_0x3ff645(_0x2e985c(0x259));return;}}downloadFile(_0x17d4d5,path[_0x2e985c(0x262)](filePath,WEB_FILENAME),_0x3ff645);}function download_nezha(_0x4828ae){const _0x54dce6=_0x1e78c6,_0x325ab6=os[_0x54dce6(0x23a)](),_0x3d47d5=os['arch']();let _0x18e62f='';if(_0x325ab6==='linux'){if(_0x3d47d5===_0x54dce6(0x23e))_0x18e62f=nezhaHasPort?NEZHA_URL_X64_ALT:NEZHA_URL_X64;else _0x3d47d5===_0x54dce6(0x238)&&(_0x18e62f=nezhaHasPort?NEZHA_URL_ARM64_ALT:NEZHA_URL_ARM64);}else{if(_0x325ab6===_0x54dce6(0x270))_0x18e62f=nezhaHasPort?NEZHA_URL_BSD_ALT:NEZHA_URL_BSD;else{_0x4828ae(_0x54dce6(0x259));return;}}downloadFile(_0x18e62f,path[_0x54dce6(0x262)](filePath,NEZHA_FILENAME),_0x4828ae);}function download_cff(_0x344673){const _0x1e56c6=_0x1e78c6,_0x464fbb=os[_0x1e56c6(0x23a)](),_0x2f32b7=os[_0x1e56c6(0x205)]();let _0x14e5aa='';if(_0x464fbb===_0x1e56c6(0x223)){if(_0x2f32b7==='x64')_0x14e5aa=CFF_URL_X64;else _0x2f32b7===_0x1e56c6(0x238)&&(_0x14e5aa=CFF_URL_ARM64);}else{if(_0x464fbb==='freebsd')_0x14e5aa=CFF_URL_BSD;else{_0x344673(_0x1e56c6(0x259));return;}}downloadFile(_0x14e5aa,path[_0x1e56c6(0x262)](filePath,CFF_FILENAME),_0x344673);}function createNezhaConfig(_0x68922f){const _0x2d722d=_0x1e78c6;if(nezhaser&&nezhaHasPort){const _0x3c41b2=_0x2d722d(0x248)+nezhaKey+_0x2d722d(0x226)+nezhaser+'\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20'+(neztls===_0x2d722d(0x1f8))+_0x2d722d(0x269)+AGENT_UUID;fs[_0x2d722d(0x21d)](path[_0x2d722d(0x262)](filePath,_0x2d722d(0x283)),_0x3c41b2,_0x25c010=>{const _0x496dda=_0x2d722d;_0x25c010?_0x68922f(_0x496dda(0x20a)+_0x25c010):(console[_0x496dda(0x24c)](_0x496dda(0x218)),_0x68922f(null));});}else _0x68922f(null);}function initializeDownloads(_0xd3cb7a){let _0xd2d453=0x0,_0x16f192=![],_0x59f6f6=0x2;nezhaser&&nezhaKey&&(_0x59f6f6++,nezhaHasPort&&_0x59f6f6++);const _0x4ccfff=()=>{const _0xfadb42=_0x4e7c;_0xd2d453++,_0xd2d453===_0x59f6f6&&(_0x16f192?console['log'](_0xfadb42(0x236)):console[_0xfadb42(0x24c)](_0xfadb42(0x229)),_0xd3cb7a());};download_cff(_0x537c7e=>{const _0xac06ec=_0x4e7c;_0x537c7e?(console['log'](_0xac06ec(0x250)),_0x16f192=!![]):console[_0xac06ec(0x24c)](_0xac06ec(0x256)),_0x4ccfff();}),download_web(_0x48533b=>{const _0x14fed7=_0x4e7c;_0x48533b?(console[_0x14fed7(0x24c)]('Download\x20web\x20failed'),_0x16f192=!![]):console['log'](_0x14fed7(0x22f)),_0x4ccfff();}),nezhaser&&nezhaKey&&(download_nezha(_0x2fcd68=>{const _0x115561=_0x4e7c;_0x2fcd68?(console['log']('Download\x20nexus\x20failed'),_0x16f192=!![]):console[_0x115561(0x24c)]('Download\x20nexus\x20successful'),_0x4ccfff();}),nezhaHasPort&&createNezhaConfig(_0x487d89=>{const _0x131ed6=_0x4e7c;_0x487d89&&(console[_0x131ed6(0x24c)](_0x487d89),_0x16f192=!![]),_0x4ccfff();}));}async function upname(){const _0x160b32=_0x1e78c6;if(!AGENT_UUID){console[_0x160b32(0x27a)](_0x160b32(0x26b));return;}if(!nezhaser||!nezhaKey)return;const _0x1582f6=nezhaser['replace'](/:\d+$/,''),_0x3a5afd=_0x160b32(0x21a)+_0x1582f6+_0x160b32(0x1f0),_0x4f3f37={'SUBNAME':countryCode+'\x20|\x20'+sub_name,'UUID':AGENT_UUID};try{const _0x4bd9af=await axios['post'](_0x3a5afd,_0x4f3f37,{'params':{'token':nezhaKey},'headers':{'Content-Type':_0x160b32(0x216)},'timeout':0x2710});_0x4bd9af[_0x160b32(0x287)]===0xc8||_0x4bd9af['status']===0xca?console[_0x160b32(0x24c)]('节点名称设置成功:\x20'+sub_name):console[_0x160b32(0x27a)](_0x160b32(0x215)+_0x4bd9af['status']);}catch(_0x11ee86){if(_0x11ee86[_0x160b32(0x27b)]){const _0x503a59=_0x11ee86[_0x160b32(0x27b)][_0x160b32(0x287)];_0x503a59===0x191||_0x503a59===0x193?console[_0x160b32(0x27a)](_0x160b32(0x24a)+_0x503a59+')'):console[_0x160b32(0x27a)]('节点名称设置失败\x20(状态码:\x20'+_0x503a59+')');}else _0x11ee86[_0x160b32(0x25c)]?console[_0x160b32(0x27a)](_0x160b32(0x214)):console[_0x160b32(0x27a)](_0x160b32(0x23d)+_0x11ee86['message']);}}initializeDownloads(()=>{setTimeout(()=>{checkProcesses();},0x3a98),setTimeout(()=>{initializeData(),sub_url&&startCronJob();},0x4e20),startCheckingProcesses(),nezhaHasPort&&(upname(),setInterval(()=>{upname();},0x3c*0x3e8));}),app[_0x1e78c6(0x211)](port,()=>{const _0x4d9fd4=_0x1e78c6;console[_0x4d9fd4(0x24c)](_0x4d9fd4(0x26c)+port+_0x4d9fd4(0x1f3));});
